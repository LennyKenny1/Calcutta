<script>
    // Function to toggle dropdown content visibility
    function toggleDropdown(dropdown) {
        dropdown.classList.toggle('active');
    }

    // Collapse other dropdowns when one is opened
    function collapseOtherDropdowns(activeDropdown) {
        document.querySelectorAll('.dropdown').forEach(function (dropdown) {
            if (dropdown !== activeDropdown && dropdown.classList.contains('active')) {
                dropdown.classList.remove('active');
            }
        });
    }

    // Collapse dropdown when clicking outside of dropdown
    window.addEventListener('click', function (event) {
        document.querySelectorAll('.dropdown').forEach(function (dropdown) {
            if (!dropdown.contains(event.target)) {
                dropdown.classList.remove('active');
            }
        });
    });

    // Add event listener for dropdown toggles
    document.querySelectorAll('.dropdown-toggle').forEach(function(toggle) {
        toggle.addEventListener('click', function(event) {
            var dropdown = toggle.parentElement;
            toggleDropdown(dropdown);
            collapseOtherDropdowns(dropdown);
            event.stopPropagation();
        });
    });

    // Add event listener for dropdown arrows to collapse dropdown content if expanded
    document.querySelectorAll('.dropdown-arrow').forEach(function(arrow) {
        arrow.addEventListener('click', function(event) {
            var dropdown = arrow.parentElement;
            if (dropdown.classList.contains('active')) {
                dropdown.classList.remove('active');
            }
            event.stopPropagation();
        });
    });

    // Adjust the height of the iframe based on the viewport height minus toolbar height
    function adjustIframeHeight() {
        var toolbarHeight = document.querySelector('.toolbar').offsetHeight;
        var iframe = document.querySelector('iframe');
        if (iframe) {
            var windowHeight = window.innerHeight;
            iframe.style.height = (windowHeight - toolbarHeight) + 'px';
        }
    }
    
    // Hide sheet tabs
    function hideSheetTabs() {
        var iframe = document.getElementById('embeddedSheet');
        var sheetTabsContainer = iframe.contentDocument.querySelector('.docs-sheet-tab-area');
        if (sheetTabsContainer) {
            sheetTabsContainer.style.display = 'none';
        }
    }

    // Call the adjustIframeHeight function when the window is resized
    window.addEventListener('resize', adjustIframeHeight);
    
    // Call the hideSheetTabs function after iframe content is loaded
    document.getElementById('embeddedSheet').addEventListener('load', function() {
        hideSheetTabs();
        adjustIframeHeight();
    });
</script>
